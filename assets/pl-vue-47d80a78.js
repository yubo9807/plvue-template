var Ut=Object.defineProperty;var Vt=(t,r,e)=>r in t?Ut(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var w=(t,r,e)=>(Vt(t,typeof r!="symbol"?r+"":r,e),e),bt=(t,r,e)=>{if(!r.has(t))throw TypeError("Cannot "+e)};var ot=(t,r,e)=>(bt(t,r,"read from private field"),e?e.call(t):r.get(t)),j=(t,r,e)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,e)};var P=(t,r,e)=>(bt(t,r,"access private method"),e);function wt(){return Number((Math.random()+"").slice(2)).toString(32)}function z(...t){console.warn(...t)}function h(t){return t.length}function ht(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function Kt(t){return t.toString().slice(0,5)==="class"}function O(t){return["object","array"].includes(ht(t))}function zt(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function dt(t,r){if(O(t)&&O(r)){const e=Object.keys(t),n=Object.keys(r);if(h(e)!==h(n))return!1;for(const o of e)if(!n.includes(o)||!dt(t[o],r[o]))return!1;return!0}else return t===r}function rt(){return typeof window=="object"}function N(t){return ht(t)==="object"}function Y(t){return Array.isArray(t)}function x(t){return typeof t=="string"}function y(t){return typeof t=="function"}function at(t){Promise.resolve().then(t)}class M extends WeakMap{}function R(t,r={}){const e=new M,n=["null","regexp","date","weakset","weakmap"],o=Object.assign({function(s){const i=function(...u){return s.apply(this,u)};return i.prototype=c(s.prototype),i},set(s){const i=new Set;for(const u of s)i.add(c(u));return i},map(s){const i=new Map;for(const[u,a]of s.entries())i.set(u,c(a));return i}},r);function c(s){if(rt()&&s instanceof HTMLElement)return s.cloneNode(!0);const i=ht(s);if(!["object","function"].includes(typeof s)||n.includes(i))return s;if(e.has(s))return e.get(s);if(o[i])return o[i](s);const u=Y(s)?[]:{};Object.setPrototypeOf(u,Object.getPrototypeOf(s)),e.set(s,u);for(const a in s)s.hasOwnProperty(a)&&(u[a]=c(s[a]));return u}return c(t)}function G(t,r){return Object.assign({},t,r)}function p(t,r,e){let n=0;for(;n<t.length;){if(t.hasOwnProperty(n)){const o=t[n];r.apply(e,[o,n,e])}n++}}let L=null;const J=new M;function U(t){L=t,t(),L=null}function Yt(t){const r=J.get(t)||[],e=r.some(n=>L===n);L&&!e&&(r.push(L),J.set(t,r))}function St(t){const r=J.get(t);r&&p(r,(e,n)=>{e()===!0&&(r.splice(n,1),J.set(t,r))})}const Gt=new M,st=new M,Q={RAW:Symbol("__v_raw"),IS_READONLY:Symbol("__v_isReadonly")};function W(t){if(!O(t)||Object.isFrozen(t))return z(`lue cannot be made reactive: ${t}`),t;if(Gt.get(t))return t;let r=null;return new Proxy(t,{get(e,n,o){if(n===Q.RAW)return e;const c=Reflect.get(e,n,o);return Yt(e),O(c)?W(c):c},set(e,n,o,c){if(e[Q.IS_READONLY]||Reflect.get(e,n,c)===o)return!0;const i=Reflect.set(e,n,o,c),u=st.get(e)||new Set;u.add(n);const a=u.size;return st.set(e,u),at(()=>{i&&a===1&&St(e),st.delete(e)}),i},deleteProperty(e,n){const o=Reflect.get(e,n),c=zt(e,n),s=Reflect.deleteProperty(e,n);return r=n,at(()=>{c&&s&&o!==void 0&&n===r&&(St(e),r=null)}),s}})}function Jt(t){return N(t)&&!!t[Q.RAW]}function mt(t){return Jt(t)?t[Q.RAW]:t}function Qt(t){const r={value:t},e=W(r);function n(){return e.value}function o(c){e.value=c}return[n,o,r]}const Xt=Symbol("__v_isRef");var ge;class Zt{constructor(r){w(this,ge,!0);w(this,"_rawValue");w(this,"_value");w(this,"getSignal");w(this,"setSignal");const[e,n,o]=Qt(r);this._rawValue=o,this.getSignal=e,this.setSignal=n,this._value=e()}get value(){return this.getSignal()}set value(r){this.setSignal(r)}}ge=Xt;function vt(t=void 0){return new Zt(t)}function te(t,r,e={}){let n=!1;if(n)return;const o=t();e.immediate&&r(o,void 0);let c=R(o),s=!0;return U(()=>{if(n)return!0;const i=t();if(O(i)){e.deep&&!dt(i,c)&&(r(i,c),c=R(i));return}if(s){s=!1;return}i!==c&&(r(i,c),c=i)}),()=>{n=!0}}function F(t){return["string","number"].includes(typeof t)&&t!==""}function jt(t){return!/^on/.test(t)}function ee(t){return N(t)&&x(t.tag)}function S(t){return y(t)&&!A(t)}function Pt(t){return Kt(t)&&t.prototype&&t.prototype.render}function Rt(t){return[void 0,null,"",!0,!1].includes(t)}function $t(...t){return t.filter(e=>F(e)).join(" ").trim().replace(/\s+/," ")}function it(t){return document.createTextNode(t)}function $(t,r){t.appendChild(r)}function g(t,r,...e){const n={tag:t,attrs:r||{},children:e};return S(n.tag)&&h(n.children)===0&&n.attrs.children&&(n.children=n.attrs.children),n}function E({children:t}){return t}const X=Symbol("Fragment");E.prototype[X]=X;function A(t){return y(t)&&t.prototype&&t.prototype[X]===X}const V=new M;function Lt(t,r=[]){return p(t,e=>{N(e)&&(S(e.tag)?(r.push({comp:e.tag,props:G(e.attrs,{children:t})}),p(e.children,n=>{S(n)&&r.push({comp:n,props:{}})})):F(e.tag)&&Lt(e.children,r))}),r}function gt(t,r=[]){const e=V.get(t)||[];return r.push(...e),p(e,n=>{const o=gt(n.comp);r.push(...o)}),r}let Nt=null;function ne(t,r){"ref"in r&&(r.ref.value=Nt),Nt=null}const Tt=[];function re(){p(Tt,t=>t()),Tt.length=0}const Mt=[];function oe(){p(Mt,t=>t()),Mt.length=0}const kt=new M;function Ct(t){const r=gt(t).map(n=>n.comp);r.unshift(t);const e=[];p(r,n=>{const o=kt.get(n)||[];e.push(...o),kt.delete(n)}),p(e,n=>n())}const xt=new M;function Et(t){const r=gt(t).map(n=>n.comp);r.unshift(t);const e=[];p(r,n=>{const o=xt.get(n)||[];e.push(...o),xt.delete(n)}),p(e,n=>n())}class se{constructor(r){w(this,"config");this.config=r}intercept(r){return r}renderToString(r){return this.createHTML(r)}createHTML(r){const{tag:e,attrs:n,children:o}=this.intercept(r);if(A(e)){const i=G(n,{children:o}),u=e(i);return this.createHTMLFragment(u)}if(S(e)){if(Pt(e)){const a=new e({...n,children:o});return this.createHTML(a.render.bind(a))}const i=G(n,{children:o}),u=e(i);return this.createHTML(u)}let c="";for(const i in n){if(i.startsWith("on")||i==="ref")continue;let u=y(n[i])&&jt(i)?n[i]():n[i];if(x(e)&&["innerHTML","innerText"].includes(i)){r.children=[u];continue}if(i==="className"){u&&(c+=` class="${$t(...[u].flat())}"`);continue}if(i==="style"&&N(u)){for(const a in u)y(u[a])&&(u[a]=u[a]());u='"'+JSON.stringify(u).slice(1,-1).replace(/"/g,"").replace(/,/g,";")+'"'}c+=` ${i}="${u}"`}const s=this.createHTMLFragment(o);return`<${e}${c}>${s}</${e}>`}createHTMLFragment(r){let e="";return p(r,n=>{if(F(n)){e+=n.toString();return}if(Y(n)){e+=this.createHTMLFragment(n);return}if(y(n)){const o=n();e+=this.createHTMLFragment([o]);return}if(N(n)){e+=this.createHTML(n);return}z(`renderToString: 不支持 ${n} 值渲染`)}),e}}var q,ft,et,At,nt,Dt;class ie extends se{constructor(e){super(e);j(this,q);j(this,et);j(this,nt)}render(e){const n=this.createElement(e);return re(),at(oe),n}createElement(e){const{tag:n,attrs:o,children:c}=this.intercept(e);if(x(n))return this.createRealNode(n,o,c);if(A(n))return this.createNodeFragment(c);if(S(n))return this.createComponent(n,o,c)}createComponent(e,n,o){if(Pt(e)){const i=new e({...n,children:o});e=i.render.bind(i)}const c=G(n,{children:o}),s=e(c);return ne(e,n),F(s)?it(s):(V.set(e,Lt([s,...s.children])),this.createElement(s))}createRealNode(e,n={},o=[""]){const c=document.createElement(e);p(o,s=>{if(this.intercept(s),y(s)){const i=this.createNodeFragment([s]);$(c,i)}else P(this,q,ft).call(this,c,s)});for(const s in n)P(this,et,At).call(this,c,s,n[s]);if(n.style&&N(n.style))for(const s in n.style){const i=n.style[s];y(i)?U(()=>c.style[s]=i()):c.style[s]=i}return c}createNodeFragment(e){const n=document.createDocumentFragment();return p(e,o=>{this.intercept(o),y(o)?P(this,nt,Dt).call(this,n,o):P(this,q,ft).call(this,n,o)}),n}createNode(e){if(F(e))return it(e);if(ee(e))return this.createRealNode(e.tag,e.attrs,e.children);if(A(e.tag))return this.createNodeFragment(e.children);if(S(e.tag))return this.createComponent(e.tag,e.attrs,e.children)}}q=new WeakSet,ft=function(e,n){if(!Rt(n)){if(Y(n)){const o=this.createNodeFragment(n);$(e,o);return}if(F(n)||N(n)){const o=this.createNode(n);$(e,o);return}z(`render: 不支持 ${n} 值渲染`)}},et=new WeakSet,At=function(e,n,o){if(n==="ref"&&N(o)){o.value=e;return}if(n==="created"&&y(o)){o(e);return}let c=s=>e[n]=s;n==="className"?c=s=>e[n]=$t(...[s].flat()):n.startsWith("data-")&&(c=s=>e.dataset[n.slice(5)]=s),jt(n)&&y(o)?U(()=>c(o())):c(o)},nt=new WeakSet,Dt=function(e,n){let o=[],c=!0,s=null;const i=it("");$(e,i),U(()=>{let u=n();if(u&&N(u)&&A(u.tag)){z("不支持响应式节点片段渲染");return}Y(u)||(u=[u]),u=u.filter(f=>!Rt(f));let a=0;for(;a<h(u);){let f=u[a];const d=ce(o,a);if(d>=0){if(dt(f,o[d].tree)){a++;continue}const m=this.createNode(f);if(!m){u.splice(d,1),a++;continue}const k=o[d].tree;if(S(k.tag)&&Ct(k.tag),o[d].node.parentElement.replaceChild(m,o[d].node),S(k.tag)){const _=k.tag;Et(_),V.delete(_)}o[d].tree=f,o[d].node=m}else{const m=this.createNode(f);if(!m){a++;continue}if(c)$(e,m);else if(h(o)===0)s??(s=i.parentElement),s.insertBefore(m,i.nextSibling);else{const k=o[h(o)-1].node,_=k.nextSibling;k.parentElement.insertBefore(m,_)}o.push({key:a,tree:f,node:m})}a++}if(h(o)>h(u)){for(let f=h(u);f<h(o);f++){const d=o[f].tree;if(S(d.tag)&&Ct(d.tag),o[f].node.remove(),S(d.tag)){const m=d.tag;Et(m),V.delete(m)}}o.splice(h(u),h(o)-h(u))}c=!1})};function ce(t,r){let e=0,n=h(t)-1;for(;e<=n;){const o=Math.ceil((e+n)/2),c=t[o];if(r===c.key)return o;r<c.key?n=o-1:r>c.key&&(e=o+1)}return-1}var I;class ue extends ie{constructor(e){super(e);w(this,"version",{}.version);j(this,I,new Map);this.config=e}use(e){return e.install(this),this}intercept(e){if(x(e.tag)){const n=ot(this,I).get(e.tag);n&&(e.tag=n)}return e}component(e,n){return ot(this,I).set(e,n),this}}I=new WeakMap;function be(t={}){return new ue(t)}function ae(t){const r={};return t.replace(/([^?&=]+)=([^&]+)/g,(e,n,o)=>r[n]=o),r}function Z(t){const r=new URL("http://0.0.0.0"+t);return{fullPath:r.href.replace(r.origin,""),path:r.pathname,query:ae(r.search),hash:r.hash,meta:{}}}function fe(t){let r="";for(const n in t.query)t.query[n]&&(r+=`${n}=${t.query[n]}&`);r=r?"?"+r.slice(0,-1):"";let e=t.hash?"#"+t.hash:"";return t.path+r+e}function K(t){return t.replace(/\/{1,}/g,"/")}function Ht(t,r){x(t)&&(b.mode==="history"&&(t=b.base+t),t=Z(t));for(const n in t)l[n]=t[n];const{fullPath:e}=l;rt()&&(b.mode==="history"?history[r==="push"?"pushState":"replaceState"]({},"",e):location.hash=e)}function qt(t){Ht(t,"push")}function yt(t){Ht(t,"replace")}function ct(t){history.go(t)}function le(){return{back:()=>ct(-1),forward:()=>ct(1),go:ct,push:qt,replace:yt,options:b,currentRoute:mt(l)}}function It(){return l}const b={base:"",mode:"history",ssrDataKey:"g_initialProps"};let Wt=null,l=null;function pe(t){l=t}function Ft(){const{origin:t,href:r,hash:e}=location;return b.mode==="hash"?e.replace("#",""):r.replace(t+b.base,"")}let H=null;function we(t={}){if(Object.assign(b,t),rt()){const e=Z(Ft());l=W(e),window.addEventListener("popstate",()=>{const n=Z(Ft());for(const o in n)l[o]=n[o]})}const r=le();return{install(e){Wt=e,e.$router=r,e.$route=It()},...r,beforeEach(e){H=e}}}const v={currentTemplate:"",ssrData:{}};function Se(t){}function _t(t,r){r=r.replace(b.base,"");const e=t.find(u=>{const{path:a,exact:f}=u.attrs;return f===!1?(r+"/").startsWith(K(a+"/")):K(a)===r});if(!e)return;const{path:n,component:o,beforeEnter:c,meta:s,redirect:i}=e.attrs;return{path:K(n),component:o,meta:s,beforeEnter:c,redirect:i}}let C;const Ot=[];function he(t){const r=vt();let e={};function n(c){const s=_t(t.children,c);if(!s){e={},r.value=t.notFound;return}async function i(){if(s.component.prototype||(s.component=(await s.component()).default),r.value===s.component)return;e.path=s.path;const a=pt(s.component);if(a){const f=window[b.ssrDataKey];f&&e.path in f?(e.data=f[e.path],delete f[e.path]):e.data=await a(R(e))}r.value=s.component,e.meta=s.meta,l.meta=s.meta}if(s.redirect&&s.redirect!==l.fullPath){yt(s.redirect),n(l.path);return}function u(a){a(mt(l),C,()=>{C=R(l),c===l.path?i():n(l.path)})}if(H){u(H);return}if(s.beforeEnter){u(s.beforeEnter);return}C=R(l),i()}const o=te(()=>l.path,c=>{if(C){const s=C.path.split("/"),i=c.split("/");s[1]!==i[1]&&p(Ot,u=>u())}n(c)},{immediate:!0});return t.prefix&&Ot.push(o),g(E,null,()=>g(r.value,{...e}))}const D=W([]);function lt(t){const r=D.indexOf(t);D.splice(r,1)}let T=null;function Bt(t){function r(i){let u=_t(t.children,i);if(u.redirect&&u.redirect!==l.fullPath)return pe(Z(u.redirect)),r(l.path);function a(f){return T=`b_${wt()}`,D.push(T),f(mt(l),C,()=>{C=R(l),u.path!==l.path?Bt(t):(B(T,u.component,{path:u.path,meta:u.meta}),lt(T))}),T}return H?a(H):u.beforeEnter?a(u.beforeEnter):u}let e=r(l.path);if(x(e))return g(E,null,e);if(!e){const i=t.notFound;return g(i||E,null)}e=e;let n=e.component;l.meta=e.meta;const o={path:e.path,meta:e.meta};T&&(B(T,n,o),lt(T));const c=`r_${wt()}`;if(!n.prototype)return D.push(c),n().then(async i=>{n=i.default;const u=pt(n);u&&(o.data=await u(R(o)),v.ssrData[o.path]=o.data),B(c,n,o)}),g(E,null,c);const s=pt(n);return s?(D.push(c),s(R(o)).then(i=>{o.data=i,v.ssrData[o.path]=i,B(c,n,o)}),g(E,null,c)):g(n,{...o})}function Re(t){return p(t.children,r=>{t.prefix&&(r.attrs.path=K(t.prefix+r.attrs.path)),r.children=[r.attrs.component]}),rt()?g(he,{...t}):g(Bt,{...t})}function B(t,r,e){const n=Wt.renderToString(g(r,{...e}));lt(t);const o=v.currentTemplate.replace(t,n);v.currentTemplate=o}function pt(t){const{getInitialProps:r}=t.prototype;if(r&&y(r))return r}function Ne(t){const{to:r,type:e,className:n,children:o,...c}=t,s=It();x(r)||(t.to=fe(Object.assign({},s,r)));const i=b.mode==="hash"?`${b.base}#${t.to}`:b.base+t.to;function u(a){a.preventDefault(),e==="replace"?yt(t.to):qt(t.to)}return g("a",{className:()=>{const a=t.to+"/",f=s.path+"/";return[f.startsWith(a)&&"active",f===a&&"exact-active",n]},href:i,onclick:u,...c},o)}const tt=Symbol("action");function de(t){return y(t)&&t.prototype[tt]===tt}class me{constructor(r,e){w(this,"state");w(this,"actions");this.state=W(R(r)),this.actions={};for(const n in e){let c=function(...s){const i=e[n].bind(r)(...s);if(O(i)&&i[Symbol.toStringTag]==="Promise")i.then(u=>(o._merge(r),u));else return o._merge(r),i};const o=this;c.prototype[tt]=tt,o.actions[n]=c}Object.assign(this.state,this.actions);for(const n in this.actions)Object.defineProperty(this.state,n,{writable:!1})}_merge(r){const e=R(r),n=Object.keys(e);for(const o in e)this.state[o]=e[o];for(const o in this.state)de(this.state[o])||!n.includes(o)&&delete this.state[o]}}const ut=new M;function Te(t){const{id:r,state:e,actions:n}=t;return()=>{if(!ut.has(e)){const o=new me(e,n);ut.set(e,o.state)}return ut.get(e)}}export{E as F,Ne as L,Re as R,Se as a,we as b,be as c,Te as d,g as h,vt as r};
